function browser(){for(var e="unknown browser",t=navigator.userAgent,o=[{agent:t.search("Edge"),browser:"Edge"},{agent:t.search("OPR"),browser:"Opera"},{agent:t.search("Opera"),browser:"Opera"},{agent:t.search("Firefox"),browser:"Firefox"},{agent:t.search("Chrome"),browser:"Chrome"},{agent:/CriOS/i.test(t)&&/iphone|ipod|ipad/i.test(t),browser:"Chrome"},{agent:t.search("Safari"),browser:"Safari"},{agent:t.search("MSIE 7"),browser:"IE7"},{agent:t.search("MSIE 8"),browser:"IE8"},{agent:t.search("MSIE 9"),browser:"IE9"},{agent:t.search("MSIE 10"),browser:"IE10"},{agent:t.search("like Gecko"),browser:"IE11"},{agent:t.search("MSIE"),browser:"IE"}],n=0;n<o.length;n++)this[o[n].browser.toLowerCase()]=!1;for(var r=0;r<o.length;r++)if(0<o[r].agent||!0===o[r].agent){this[o[r].browser.toLowerCase()]=!0,e=o[r].browser;break}return e}function render(e,t){document.querySelectorAll("#grid_section img")[t].src=e}function toDataURL(e,t,o){var n=new XMLHttpRequest;n.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result,o)},e.onerror=function(){popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML='Some error occurred</br><a href="/?back=id">Back to get top9 post again</a>'})},e.readAsDataURL(n.response)},n.onerror=function(){popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML='Some error occurred</br><a href="/?back=id">Back to get top9 post again</a>'})},n.open("GET",e),n.responseType="blob",n.send()}function createDownloadGrid(e,t){t=t.cloneNode(!0);t.setAttribute("id","grid_download"),t.style.width="1280px",t.style.height="1280px",t.style.maxWidth="1280px",t.style.maxHeight="1280px",e.appendChild(t);for(var o=t.querySelectorAll("img"),n=0;n<o.length;n++)o[n].classList.remove("preview"),computeGirdPosition(o[n]);return t}function destoryDownloadGrid(){var e=document.querySelector("#grid_download");e.innerHTML="",e.remove()}function computeGirdPosition(e){var t,o,n=parseFloat(window.getComputedStyle(e).width,10),r=parseFloat(window.getComputedStyle(e).height,10);e.style.position="absolute",console.log(n,r,n-r),n-r<5?(t=parseFloat(window.getComputedStyle(e.parentNode).width,10),o=parseFloat(window.getComputedStyle(e.parentNode).height,10),console.log(t,o),o<t&&(e.style.top="50%",e.style.left="0",e.style.width="100%",e.style.height="auto",r=parseFloat(window.getComputedStyle(e).height,10),e.style.marginTop="-"+r/2+"px"),t<o&&(e.style.top="0",e.style.left="50%",e.style.width="auto",e.style.height="100%",n=parseFloat(window.getComputedStyle(e).width,10),e.style.marginLeft="-"+n/2+"px")):r<n?(e.style.top="0",e.style.left="50%",e.style.height="100%",e.style.width="auto",n=parseFloat(window.getComputedStyle(e).width,10),e.style.marginLeft="-"+n/2+"px"):n<r&&(e.style.top="50%",e.style.left="0",e.style.marginTop="-"+r/2+"px")}function initDownloadImage(e,t){e.style.width=t+"px",e.style.height=t+"px",e.style.maxWidth=t+"px",e.style.maxHeight=t+"px";for(var o=e.querySelectorAll(".liked_count"),n=0;n<o.length;n++)o[n].style.fontSize="2rem",o[n].querySelector("svg").setAttribute("width","32"),o[n].querySelector("svg").setAttribute("height","32")}function resetDownloadImage(e){e.style.width="calc(100vw - 1rem*2)",e.style.height="calc(100vw - 1rem*2)",e.style.maxWidth="640px",e.style.maxHeight="640px";for(var t=e.querySelectorAll(".liked_count"),o=0;o<t.length;o++)t[o].style.fontSize="1rem",t[o].querySelector("svg").setAttribute("width","16"),t[o].querySelector("svg").setAttribute("height","16")}function downloadURI(){var e="top9_grid.png",t=document.querySelector("canvas").toDataURL({pixelRatio:1});t=(t=t.replace(/^data:image\/[^;]*/,"data:application/octet-stream")).replace(/^data:application\/octet-stream/,"data:application/octet-stream;headers=Content-Disposition%3A%20attachment%3B%20filename="+e);var o=document.createElement("a");o.download=e,o.href=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),delete o}function getQueryString(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function padding(e){content.innerHTML='<div class="get_msg">Lots of people use now, please visit this url latter</div><a class="get_msg" href="'+host+"/id.html?id="+e+'" target="_blank">'+host+"/id.html?id="+e+"</a>"}function errorCode(e){switch(e){case 0:case"0":console.info("ok");break;case 1:case"1":console.info("padding");break;case 2:case"2":console.info("private"),popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML="This Instagram id is private account"});break;case 3:case"3":console.info("job not existing"),popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML="Some error occurred, please back to home page & try again",setTimeout(function(){location.href="/"},3e3)});break;case 100:case"100":console.info("no user"),popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML="This Instagram id is not exist"})}}function likeSVG(){return'<svg fill="#ed4956" height="16" viewBox="0 0 48 48" width="16"><path d="M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"></path></svg>'}function thousandth(e){if("number"==typeof e&&(e+=""),"string"==typeof e){for(var t=0,o="",n=e.length-1;0<=n;n--)3===t&&(o=","+o,t=0),o=e[n]+o,t++;return o}console.error("argument type error")}function initGrid(e,t){var o=t.length,n=[];switch(o){case 1:n=["pure-u-1-1"];break;case 2:n=["pure-u-1-2","pure-u-1-2"];break;case 3:case 4:n=["pure-u-1-2","pure-u-1-2","pure-u-1-2","pure-u-1-2"];break;case 5:case 6:n=["pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3"];break;case 7:case 8:case 9:n=["pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3","pure-u-1-3"]}for(var r=0;r<o;r++){var i=document.createElement("div");i.classList.add(n[r]),i.classList.add("grid_section"),i.classList.add("grid_section_"+o);var a=document.createElement("div");a.classList.add("grid_wrap");var s=document.createElement("img");s.classList.add("preview"),a.appendChild(s),i.appendChild(a);a=document.createElement("div");a.setAttribute("class","liked_count vertical_centering"),a.innerHTML=likeSVG()+" "+thousandth(t[r].like_count),i.appendChild(a),e.appendChild(i)}return e}function submitCrawler(){document.querySelector("form")?(document.querySelector("form input[name=id]").addEventListener("blur",function(e){this.value=this.value.toLowerCase().trim()}),document.querySelector("form").addEventListener("submit",function(e){e.preventDefault();var t=this,e=new RegExp(/^(?!.*\.\.)(?!.*\.$)[^\W][\w.]{0,29}$/),o=document.querySelector("input[name=id]").value.toLowerCase();o?e.test(o)?grecaptcha.ready(function(){grecaptcha.execute("6LcwTPMZAAAAAIEoRQ2fm2cVMWWfvpeUJQX_CgcZ",{action:"submit"}).then(function(e){ajax({method:"POST",url:url+o,data:{token:e},response:"json",success:function(e){0==e.code||1==e.code?t.submit():errorCode(e.code)},error:function(e,t){console.error("POST error: "+e,t)}})})}):popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML="Please fill valid Instagram id"}):popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML="Please fill Instagram id"})})):console.error("no form")}function loading(e,t){var o;e?(document.querySelector("body").classList.add("loading_no_scroll"),(o=document.createElement("div")).style="position:fixed;top:0;left:0;width:100%;height:100%;background:#e6e6e6;",o.setAttribute("id","loading_layer"),(e=document.createElement("div")).style="position:absolute;top:50%;left:50%;width:80px;height:20px;margin-left:-40px;margin-top:-10px;",e.innerHTML='<div class="loading loading_run"></div>',o.appendChild(e),document.querySelector("body").appendChild(o)):(document.querySelector("body").classList.remove("loading_no_scroll"),(o=document.querySelector("#loading_layer"))&&(o.outerHTML="",o=null))}function mobile_share_module(e,t){if(e){var o=t&&t.iconLine?t.iconLine:"",n=t&&t.iconLine2x?t.iconLine2x:"",r=t&&t.iconFacebook?t.iconFacebook:"",i=t&&t.iconFacebook2x?t.iconFacebook2x:"",a=t&&t.iconMessenger?t.iconMessenger:"",s=t&&t.iconMessenger2x?t.iconMessenger2x:"",c=t&&t.iconTwitter?t.iconTwitter:"",l=t&&t.iconTwitter2x?t.iconTwitter2x:"",p=t&&t.iconPinterest?t.iconPinterest:"",u=t&&t.iconPinterest2x?t.iconPinterest2x:"",d=t&&t.iconWhatsapp?t.iconWhatsapp:"",h=t&&t.iconWhatsapp2x?t.iconWhatsapp2x:"",g=t&&t.fbAppId?"&app_id="+t.fbAppId:"",m=t&&t.twitterText?"&text="+t.twitterText:"",t=t&&t.twitterRef?"&original_referer="+t.twitterRef:"";return{line:{href:"https://line.naver.jp/R/msg/text/?"+encodeURIComponent(e),icon:o,icon_2x:n},facebook:{href:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e),icon:r,icon_2x:i},messenger:{href:"fb-messenger://share/?link="+encodeURIComponent(e)+g,icon:a,icon_2x:s},pinterest:{href:"https://pinterest.com/pin/create/link/?url="+encodeURIComponent(e),icon:p,icon_2x:u},twitter:{href:"https://twitter.com/intent/tweet?url="+encodeURIComponent(e)+m+t,icon:c,icon_2x:l},whatsapp:{href:"whatsapp://send?text="+encodeURIComponent(e),icon:d,icon_2x:h}}}console.error("url is require")}window.ajax=function(e){var t,o,n,r,i,a;if(!e)return console.error("not set arguments");if(!(t=e).method)return console.error("not set method");if(o=t.method,!t.url)return console.error("not set url");if(n=t.url,!t.success)return console.error("not set success callback");function s(e){if(!e)return"";var t,o="";for(t in e)o=o+t+"="+encodeURIComponent(e[t])+"&";return o=o.substr(0,o.length-1)}if(a=t.success,r=t.data||"","GET"===t.method&&r&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return;return 1}(r)&&(n=n+"?"+s(r)),"undefined"!=typeof XDomainRequest){var c=location.host,e=(e=n.replace("https://","").replace("http://","")).slice(0,e.indexOf("/"));if(0===n.indexOf("//")||e!==c){var l=new XDomainRequest;return l.open(o,n),l.onprogress=function(){},l.ontimeout=function(){},l.onerror=function(){},l.onload=function(){a(JSON.parse(l.responseText))},void setTimeout(function(){l.send()},0)}}if((i=new XMLHttpRequest).open(o,n),t.setRequestHeader)for(var p in t.setRequestHeader)i.setRequestHeader(p,t.setRequestHeader[p]);t.withCredentials&&(i.withCredentials=!0),"GET"!==t.method&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(s(r)),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e;switch(t.response){case"json":e=JSON.parse(i.responseText);break;case"xml":e=i.responseXML;break;default:e=JSON.parse(i.responseText)}a(e)}else{if(!t.error)return console.error("xhr.status",i.status);t.error(i.status,i.responseText)}}},window.popup=function(t){var o;function n(e){e&&e(o),o.classList.add("popup_hide"),document.body.classList.remove("popup_show")}t.dom?(o=t.dom,t.width&&(o.querySelector(".popup_container").style.width=t.width),t.height&&(o.querySelector(".popup_container").style.height=t.height),t.minWidth&&(o.querySelector(".popup_container").style.minWidth=t.minWidth),t.minHeight&&(o.querySelector(".popup_container").style.minHeight=t.minHeight),t.maxWidth&&(o.querySelector(".popup_container").style.maxWidth=t.maxWidth),t.maxHeight&&(o.querySelector(".popup_container").style.maxHeight=t.maxHeight),o.addEventListener("mousedown",function(e){n(t.dosomethingClose)}),o.querySelector(".popup_container").addEventListener("mousedown",function(e){e.stopPropagation()}),o.querySelector(".popup_close")&&o.querySelector(".popup_close").addEventListener("click",function(){n(t.dosomethingClose)}),this.show=function(e,t){e&&e(o),o.classList.remove("popup_hide"),document.body.classList.add("popup_show"),o.childNodes,o.querySelector(".popup_close")&&o.querySelector(".popup_close").addEventListener("click",function(){n(t)})},this.hide=n):console.error("popup: hide function not set dom object")};var recaptcha=document.createElement("script");recaptcha.src="https://www.google.com/recaptcha/api.js?render=6LcwTPMZAAAAAIEoRQ2fm2cVMWWfvpeUJQX_CgcZ",document.querySelector("head").append(recaptcha);var router=location.pathname,content=document.querySelector("#content"),url="https://api.top9.best/v1/ig/",host="https://top9.best";switch(router){case"/":case"/index.html":initIndex();break;case"/get":case"/get.html":initGet();break;case"/id":case"/id.html":case"/mock.html":initId();break;default:location.href="/404.html"}var popupDialog=new popup({dom:document.querySelector("#popup"),minWidth:"300px",minHeight:"160px",dosomethingClose:function(e){e.querySelector(".popup_content").innerHTML=""}});function initGet(){content.innerHTML='<div class="get_msg animate__animated animate__flash animate__infinite animate__slower">📸 Counting picture...</div><div class="get_msg animate__animated animate__flash animate__infinite animate__slower">❤️ Counting liked...</div><div class="get_msg">Please wait about 1 minute</div>';var n=getQueryString("id"),r=12;recaptcha.onload=function(){grecaptcha.ready(function(){grecaptcha.execute("6LcwTPMZAAAAAIEoRQ2fm2cVMWWfvpeUJQX_CgcZ",{action:"submit"}).then(function(e){!function o(e){ajax({method:"GET",url:url+n+"?token="+e,data:{},response:"json",success:function(e){0==e.code?location.href=host+"/id.html?id="+n:0<--r?setTimeout(function(){grecaptcha.ready(function(){grecaptcha.execute("6LcwTPMZAAAAAIEoRQ2fm2cVMWWfvpeUJQX_CgcZ",{action:"submit"}).then(function(e){o(e)})})},5e3):padding(n)},error:function(e,t){console.error("POST error: "+e,t),0<--r?setTimeout(function(){grecaptcha.ready(function(){grecaptcha.execute("6LcwTPMZAAAAAIEoRQ2fm2cVMWWfvpeUJQX_CgcZ",{action:"submit"}).then(function(e){o(e)})})},5e3):padding(n)}})}(e)})})},recaptcha.onerror=function(){popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML="Some error occurred, please try latter"})}}function initId(){content.classList.add("top9"),loading(!0);var l=decodeURIComponent(getQueryString("id"));function t(e){var t=e.post_list,o=e.total_liked_count,n=e.total_post_count,r='<a class="btn-primary" href="https://instagram.com/'+l+'/" target="_blank">'+l+"</a> Top9 in 2020",i=8<t.length?"Congratulation 🎉":"Ooops! Your posts are a bit less",a=location.href.replace(location.search,"")+"?id="+encodeURIComponent(l)+"&ref=sharing",s=mobile_share_module(a,{iconLine:"/images/icon_line_32.png",iconLine2x:"/images/icon_line_64.png",iconFacebook:"/images/icon_fb_32.png",iconFacebook2x:"/images/icon_fb_64.png",iconMessenger:"/images/icon_messenger_32.png",iconMessenger2x:"/images/icon_messenger_64.png",iconPinterest:"/images/icon_pinterest_32.png",iconPinterest2x:"/images/icon_pinterest_64.png",iconTwitter:"/images/icon_twitter_32.png",iconTwitter2x:"/images/icon_twitter_64.png",iconWhatsapp:"/images/icon_whatsapp_32.png",iconWhatsapp2x:"/images/icon_whatsapp_64.png"}),e='<a class="share_link" href="'+s.facebook.href+'" target="_blank"><img src="'+s.facebook.icon+'" srcset="'+s.facebook.icon_2x+" 1.5x, "+s.facebook.icon_2x+" 2x, "+s.facebook.icon_2x+' 3x" alt="Facebook"></a>';e=(e=(e=e+'<a class="share_link" href="'+s.line.href+'" target="_blank"><img src="'+s.line.icon+'" srcset="'+s.line.icon_2x+" 1.5x, "+s.line.icon_2x+" 2x, "+s.line.icon_2x+' 3x" alt="LINE"></a>')+'<a class="share_link" href="'+s.pinterest.href+'" target="_blank"><img src="'+s.pinterest.icon+'" srcset="'+s.pinterest.icon_2x+" 1.5x, "+s.pinterest.icon_2x+" 2x, "+s.pinterest.icon_2x+' 3x" alt="Pinterest"></a>')+'<a class="share_link" href="'+s.twitter.href+'" target="_blank"><img src="'+s.twitter.icon+'" srcset="'+s.twitter.icon_2x+" 1.5x, "+s.twitter.icon_2x+" 2x, "+s.twitter.icon_2x+' 3x" alt="Twitter"></a>',device.mobile()&&(e=(e=e+'<a class="share_link" href="'+s.messenger.href+'" target="_blank"><img src="'+s.messenger.icon+'" srcset="'+s.messenger.icon_2x+" 1.5x, "+s.messenger.icon_2x+" 2x, "+s.messenger.icon_2x+' 3x" alt="Messenger"></a>')+'<a class="share_link" href="'+s.whatsapp.href+'" target="_blank"><img src="'+s.whatsapp.icon+'" srcset="'+s.whatsapp.icon_2x+" 1.5x, "+s.whatsapp.icon_2x+" 2x, "+s.whatsapp.icon_2x+' 3x" alt="WhatsApp"></a>',e+='<a id="share_share" class="share_link" href="javascript:void(0)" target="_blank"><img src="/images/icon_share_32.png" srcset="/images/icon_share_64.png 1.5x, /images/icon_share_64.png 2x, /images/icon_share_64.png 3x" alt="WhatsApp"></a>'),content.innerHTML="<h2>"+r+"</h2><h3>"+i+"</h3><article>You get "+thousandth(o)+" ❤️ & "+thousandth(n)+' 📸 in 2020!</article><section id="grid_section" class="pure-g"></section><section id="content_download" class="pure-g"><div class="pure-u-1 pure-u-sm-1-2"><button class="btn-download" id="download">Download Image</button><p>If you can\'t download, please open this page in browser</p></div><div class="pure-u-1 pure-u-sm-1-2">'+e+'</div></section><h3>Get your Instagram top 9 in 2020!</h3><form class="pure-g" action="/get.html" method="get"><div class="pure-u-2-3"><input class="" type="text" name="id" placeholder="Input your Instagram id"></div><div class="pure-u-1-3"><button class="btn-primary">CONTINUE</button></div></form>';e=document.createDocumentFragment();document.querySelector("#grid_section").appendChild(initGrid(e,t)),device.mobile()&&document.querySelector("#share_share").addEventListener("click",function(){var e={title:"This is my top 9 liked post in 2020",text:"This is my top 9 liked post in 2020! "+thousandth(o)+" ❤️ & "+thousandth(n)+" 📸   #top9of2020",url:a};navigator.share(e).then(function(){console.log("Shared successfully")}).catch(function(e){console.error("Share Error:",e)})});for(var c=0;c<t.length;c++)toDataURL(t[c].url,render,c);document.querySelector("#download").addEventListener("click",function(e){e.preventDefault(),gtag("event","download",{event_category:"download",event_label:l,value:1}),loading(!0);var t=document.querySelector("#grid_section"),o=1280,n=0,r=0,e=!0;device.ios()||"Safari"==browser()?(t=createDownloadGrid(content,document.querySelector("#grid_section")),o=parseFloat(window.getComputedStyle(t).width,10),n=t.offsetLeft,r=t.offsetTop,e=!1):initDownloadImage(t,o),html2canvas(t,{allowTaint:!0,useCORS:!0,foreignObjectRendering:e,width:o,height:o,x:n,y:r,scale:1,scrollX:0,scrollY:0}).then(function(e){document.body.appendChild(e),downloadURI(),e.classList.add("hide"),device.ios()||"Safari"==browser()?destoryDownloadGrid():resetDownloadImage(t),setTimeout(function(){loading(!1)},1200)})}),submitCrawler()}Object.keys(source).length?(t(source),loading(!1)):(recaptcha.onload=function(){grecaptcha.ready(function(){grecaptcha.execute("6LcwTPMZAAAAAIEoRQ2fm2cVMWWfvpeUJQX_CgcZ",{action:"submit"}).then(function(e){ajax({method:"GET",url:url+l,data:{},setRequestHeader:{i_token:e},response:"json",success:function(e){loading(!1),errorCode(e.code),0==e.code&&t(e.data)},error:function(e,t){console.error("POST error: "+e,t)}})})})},recaptcha.onerror=function(){popupDialog.show(function(e){e.querySelector(".popup_content").innerHTML="Some error occurred, please try latter"})})}function initIndex(){content.classList.add("index"),content.innerHTML='<article>You can input your Instagram id to check most liked top 9 post in 2020!</article><section id="hash_tag"><a class="btn-primary" href="https://www.instagram.com/explore/tags/top9of2020/" target="_blank">#top9of2020</a></section><section><form class="pure-g" action="/get.html" method="get"><div class="pure-u-3-4"><input class="" type="text" name="id" placeholder="Input your Instagram id"></div><div class="pure-u-1-4"><button class="btn-primary">CONTINUE</button></div></form></section>',submitCrawler()}document.querySelector("#popup_close").addEventListener("click",function(){popupDialog.hide()});